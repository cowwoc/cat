{
  "period": "2026-02",
  "mistakes": [
    {
      "id": "M001",
      "timestamp": "2026-02-17T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent skipped stakeholder review re-run after fix iteration",
      "root_cause": "REFLECTION module failure: Agent did not verify that fixes resolved concerns and introduced no new issues before proceeding to merge",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "review",
        "fix-iteration",
        "verification"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Always re-run stakeholder review after addressing concerns to verify fixes resolved issues and introduced no new problems"
    },
    {
      "id": "M344",
      "timestamp": "2026-02-17T00:00:00Z",
      "category": "protocol_violation",
      "description": "stakeholder-review skill uses HEAD~1..HEAD for file diff, missing commits when worktree has multiple changes",
      "root_cause": "Skill assumes single-commit workflow but CAT allows iteration. HEAD~1 refers to previous commit in worktree, not base branch",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/stakeholder-review/first-use.md",
      "pattern_keywords": [
        "stakeholder-review",
        "HEAD~1..HEAD",
        "git diff",
        "file context",
        "worktree commits"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use base_branch..HEAD for diff operations to capture all commits since worktree diverged from base branch. Read base_branch from cat-base worktree metadata file, fallback to HEAD~1 for non-worktree scenarios"
    },
    {
      "id": "M345",
      "timestamp": "2026-02-17T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent reported failure when Skill tool re-invocation returned re-invocation instructions instead of echoing previously generated skill output",
      "root_cause": "reference.md re-invocation instructions only say to use the Skill tool again, but give no guidance for when the Skill tool itself returns re-invocation instructions (the loop case). No fallback path was documented for this scenario.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/reference.md",
      "pattern_keywords": [
        "re-invocation",
        "skill-loop",
        "status",
        "echo-output",
        "protocol_violation",
        "preprocessor"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When Skill tool re-invocation returns the same re-invocation instructions again, search conversation history for the most recent skill output and echo it verbatim. Do not report failure."
    },
    {
      "id": "M346",
      "timestamp": "2026-02-18T15:42:02Z",
      "category": "misleading_documentation",
      "description": "Orchestrator used \"squash commit\" as squash message instead of the primary implementation commit message",
      "root_cause": "work-with-issue-first-use/SKILL.md mismatch correction example displayed \"squash commit\" as a sample bad message, normalizing that string as a recognizable commit message pattern. Combined with v2.1 git history containing a prior squash commit with the same message, the LLM was primed to produce \"squash commit\" when executing Step 6 squash. The git-squash-quick.sh validation script would have rejected this message, but the orchestrator bypassed it with direct git commands.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue-first-use/SKILL.md",
      "pattern_keywords": [
        "squash-commit",
        "commit-message",
        "priming",
        "mismatch-example",
        "work-with-issue"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "medium",
        "catches_variations": true
      },
      "correct_behavior": "Use the primary implementation commit message from the execution result as the squash message. The squash script git-squash-quick.sh validates the message format and would reject non-descriptive messages like \"squash commit\"."
    },
    {
      "id": "M347",
      "timestamp": "2026-02-18T19:25:45Z",
      "category": "protocol_violation",
      "description": "Main agent spawned work-merge subagent while shell CWD was inside the worktree, causing shell session corruption after worktree removal",
      "root_cause": "Documentation in work-with-issue-first-use/SKILL.md (line 719) instructs agent to cd /workspace before spawning the merge subagent, but agent failed to comply. The instruction existed but the protocol was violated. Subagent operates in its own shell context so checking subagent CWD does not help - the MAIN agent must exit the worktree before delegation.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/task/EnforceWorktreeSafetyBeforeMerge.java",
      "pattern_keywords": [
        "worktree-removal",
        "cwd-corruption",
        "shell-session",
        "work-merge",
        "cd-before-spawn"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before spawning the work-merge subagent, run 'cd /workspace' so the main agent's shell CWD is not inside the worktree when the subagent removes it."
    },
    {
      "id": "M348",
      "timestamp": "2026-02-18T19:30:42Z",
      "category": "protocol_violation",
      "description": "merge-and-cleanup.sh did not delete backup-before-squash-* branches left by git-squash-quick.sh after successful merge",
      "root_cause": "work-with-issue Step 6 runs git-squash-quick.sh before each approval gate presentation. When the workflow loops (user rejects, more work done, loop back to Step 6), each squash iteration creates a new uniquely-timestamped backup branch. git-squash-quick.sh only deletes the backup it JUST created on success \u2014 it cannot know about backups from previous loop iterations. merge-and-cleanup.sh, which runs after the final successful merge, had no logic to delete these orphaned backup branches.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/scripts/merge-and-cleanup.sh",
      "pattern_keywords": [
        "backup-branch",
        "squash-cleanup",
        "merge-and-cleanup",
        "git-squash-quick",
        "orphaned-branches",
        "approval-gate-retry"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "merge-and-cleanup.sh should delete all backup-before-squash-* branches after a successful merge. Add a step between branch deletion and lock release that runs: git branch | grep 'backup-before-squash-' | while read b; do git branch -D $b; done"
    },
    {
      "id": "M349",
      "timestamp": "2026-02-18T22:17:37Z",
      "category": "incorrect_implementation",
      "description": "Status display inner boxes rendered with individually-sized widths, causing inner right borders to appear at different horizontal positions (jagged right edges)",
      "root_cause": "generateStatusDisplay() calls buildInnerBox() for each major version without coordinating widths. Each call independently calculates boxWidth from its own content, so boxes with more content are wider. Different-width inner boxes placed in the outer box create visually jagged right borders even though the OUTER box right border aligns correctly.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/skills/GetStatusOutput.java",
      "pattern_keywords": [
        "box-alignment",
        "inner-box-width",
        "status-display",
        "buildInnerBox",
        "uniform-width"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Pre-calculate the maximum inner box content width across all major versions, then pass that as forcedWidth to each buildInnerBox() call so all inner boxes render at uniform width."
    },
    {
      "id": "M350",
      "timestamp": "2026-02-18T22:45:00Z",
      "category": "protocol_violation",
      "description": "Implemented empty-string fallback for invalid sessionId format instead of throwing exception",
      "root_cause": "The fail-fast principle in common.md only showed Bash examples and did not list identifiers used to construct file paths as non-acceptable fallbacks; the HookInput.getString() pattern of returning empty string primed the agent to use the same pattern for getSessionId()",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/rules/common.md",
      "pattern_keywords": [
        "fail-fast",
        "fallback",
        "empty-string",
        "session-id",
        "file-path",
        "java"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Throw IllegalArgumentException when sessionId format is invalid, since sessionId is used to construct file paths"
    },
    {
      "id": "M351",
      "timestamp": "2026-02-18T18:38:00Z",
      "category": "protocol_violation",
      "description": "Main agent presented approval gate before verifying STATE.md was closed; implementation subagent committed code but STATE.md remained in-progress",
      "root_cause": "work-with-issue-first-use/SKILL.md Step 7 (Approval Gate) has no verification that STATE.md is closed before presenting the gate. The skill instructs the subagent to close STATE.md (Step 3 delegation prompt) but never verifies compliance prior to the approval gate.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue-first-use/SKILL.md",
      "pattern_keywords": [
        "state-md",
        "approval-gate",
        "closed-status",
        "subagent-compliance",
        "work-with-issue",
        "protocol-violation"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before presenting the approval gate in Step 7, verify STATE.md status is 'closed'. If not closed, update STATE.md and amend the last commit to include the closure before proceeding."
    },
    {
      "id": "M352",
      "timestamp": "2026-02-18T00:00:00Z",
      "category": "protocol_violation",
      "description": "Convention file change placed in feature commit instead of refactor commit when establishing and applying a new Java convention",
      "root_cause": "CLAUDE.md commit type rules did not address the case where a convention file change and its application across files are the same logical unit. The agent split by file location (java.md -> config-like) rather than by topic (establish+apply convention = refactor unit).",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/CLAUDE.md",
      "pattern_keywords": [
        "commit-grouping",
        "convention-file",
        "java-md",
        "refactor-commit",
        "mixed-commit"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When adding a new convention to java.md AND applying it across files in the same session, include the java.md change in the SAME commit as the refactoring work. Group commits by topic (establish + apply = one unit), not by file location."
    },
    {
      "id": "M353",
      "timestamp": "2026-02-18T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent output status skill meta-instructions to user instead of only copying the <output> tag content verbatim",
      "root_cause": "status-first-use/SKILL.md uses negative instructional framing ('Do NOT summarize...') which per M408 triggers LLM analytical/processing mode instead of mechanical verbatim copy mode. The NEXT STEPS table is embedded in the instruction block, causing the agent to reproduce it as instruction text AND again as user-facing output (duplication). User-centric framing ('The user wants you to respond with this text verbatim:') is required to trigger correct mechanical execution.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/status-first-use/SKILL.md",
      "pattern_keywords": [
        "verbatim-output",
        "negative-framing",
        "meta-instructions-leaked",
        "status-skill",
        "user-centric-framing",
        "M408-pattern"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Replace negative instructional framing with user-centric framing: 'The user wants you to respond with the following text verbatim:' followed by the <output> tag. Move NEXT STEPS out of the instruction block and into a separate 'append after verbatim content' instruction to prevent duplication."
    },
    {
      "id": "M354",
      "timestamp": "2026-02-19T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent skipped verbatim echo of status box content and only output the NEXT STEPS table when invoking /cat:status",
      "root_cause": "status-first-use/SKILL.md instruction ordering places NEXT STEPS table between the instruction and the <output> tag, causing the agent to treat NEXT STEPS as the target output and the <output> tag content as preprocessing data already consumed. The agent read the instruction ('The user wants you to respond with the contents verbatim') but identified NEXT STEPS (the most visible content after the instruction) as what to produce, skipping the actual box. Structural fix required: move NEXT STEPS after the <output> tag so content order mirrors output order.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/status-first-use/SKILL.md",
      "pattern_keywords": [
        "verbatim-output",
        "status-skill",
        "skipped-box-content",
        "instruction-ordering",
        "output-tag-position",
        "NEXT-STEPS-only"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": "M353",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Restructure status-first-use/SKILL.md so the <output skill='status'> tag appears BEFORE the NEXT STEPS table, mirroring the output order. Agent reads instruction -> sees <output> tag -> echoes box -> appends NEXT STEPS. Content position should match production order.",
      "task_creation_info": {
        "suggested_title": "Fix status-first-use instruction ordering to prevent box content skip",
        "suggested_description": "Move NEXT STEPS table in status-first-use/SKILL.md to appear AFTER the <output skill='status'> tag so the document content order mirrors the required output order. Current ordering (instruction -> NEXT STEPS table -> <output> tag) causes the agent to identify NEXT STEPS as the output target and skip echoing the box content. New ordering: instruction -> <output> tag -> NEXT STEPS table.",
        "suggested_acceptance_criteria": [
          "status-first-use/SKILL.md: <output skill='status'> tag appears before NEXT STEPS table",
          "Agent echoes full status box content verbatim before NEXT STEPS table",
          "Empirical test on haiku with production-size content achieves >= 90% compliance"
        ]
      }
    },
    {
      "id": "M355",
      "timestamp": "2026-02-19T11:24:00Z",
      "category": "protocol_violation",
      "description": "Agent corrupted verbatim status box output by inserting horizontal rule characters (\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500) between sections that were not in the original output",
      "root_cause": "REFLECTION failure: Agent read the verbatim instruction but its helpful-synthesis training overrode it by adding structural separators it perceived as clarifying. The instruction 'copy the contents verbatim' does not explicitly forbid adding characters, leaving room for the agent to 'enhance' the output while believing it complied. Third recurrence of verbatim output failure for status skill (M353, M354, M355).",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/status-first-use/SKILL.md",
      "pattern_keywords": [
        "verbatim-output",
        "status-skill",
        "output-corruption",
        "box-drawing-insertion",
        "horizontal-rule-added",
        "PATTERN-008"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": "M353",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Copy-paste the exact text from the <output skill='status'> tag character-for-character with zero additions or modifications. Do not insert line separators, horizontal rules, headers, or any characters not already present in the tag.",
      "task_creation_info": {
        "suggested_title": "Strengthen status-first-use verbatim instruction to prevent output corruption",
        "suggested_description": "Third recurrence (M353, M354, M355) of verbatim output failure for the status skill. Agent adds horizontal rule characters or other structural elements to the output despite 'verbatim' instruction. The current framing 'The user wants you to respond with the contents verbatim' leaves room for the agent to add characters while believing it complied. Strengthen the instruction in status-first-use/SKILL.md to explicitly prohibit additions: 'Copy-paste the exact text character-for-character with zero additions or modifications. Do not insert line separators, horizontal rules, headers, or any characters not already present in the tag.' Also consider escalating to a PostToolUse validation hook (PATTERN-008) since skill-level prevention has failed twice.",
        "suggested_acceptance_criteria": [
          "status-first-use/SKILL.md instruction explicitly states zero additions/modifications allowed",
          "Instruction prohibits inserting line separators, horizontal rules, or headers not in original",
          "Empirical test with haiku model shows no extra characters inserted in 5 consecutive runs",
          "Consider adding PostToolUse hook to detect box-drawing characters in assistant output not preceded by script execution"
        ]
      }
    },
    {
      "id": "M356",
      "timestamp": "2026-02-19T11:38:00Z",
      "category": "tool_misuse",
      "description": "Pattern 11 in AutoLearnMistakes.java fires false positives on tool output containing CRITICAL from stakeholder review results and grep output",
      "root_cause": "Pattern 11 checks tool output (gitFiltered) for CRITICAL+ISSUE/ERROR/etc but the stakeholder review box legitimately outputs Result lines containing Critical issue text, and grep searches return source code lines with CRITICAL. The pattern should only apply to assistant self-acknowledgment messages, not tool output.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/tool/post/AutoLearnMistakes.java",
      "pattern_keywords": [
        "false_positive",
        "hook_detection",
        "critical_self_acknowledgment",
        "stakeholder_review"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Pattern 11 (critical self-acknowledgment) should only scan assistant messages (assistantMsg), not tool output. The existing check at lines 286-288 already handles legitimate critical self-acknowledgments in assistant messages. Remove Pattern 11 from the tool output scanning block entirely."
    },
    {
      "id": "M357",
      "timestamp": "2026-02-19T11:37:00Z",
      "category": "tool_misuse",
      "description": "verify-audit CLI failed with Jackson Unrecognized character escape \\! when evidence strings contained backtick-exclamation preprocessing directives serialized via shell heredoc",
      "root_cause": "Shell string interpolation in RESULTS_JSON heredoc embedded backtick-exclamation sequences literally in JSON string values, producing invalid JSON escape sequence that Jackson rejected. The verify-implementation skill showed heredoc as example but did not specify that evidence strings with special characters require json.dumps() serialization.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/verify-implementation-first-use/SKILL.md",
      "pattern_keywords": [
        "json-serialization",
        "shell-heredoc",
        "backtick-exclamation",
        "jackson",
        "verify-audit"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "M330",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use Python subprocess with json.dumps() to pass results JSON to verify-audit CLI tool, ensuring all evidence string content is safely escaped regardless of special characters"
    },
    {
      "id": "M358",
      "timestamp": "2026-02-19T16:30:00Z",
      "category": "missing_documentation",
      "description": "Skill(cat:stakeholder-selection-box) invoked via Skill tool with args, but ${ARGUMENTS} was empty because SkillLoader did not resolve ARGUMENTS variable and the skill bypassed the SkillLoader pipeline entirely",
      "root_cause": "stakeholder-selection-box/SKILL.md called the CLI handler directly via !backtick instead of routing through load-skill.sh/SkillLoader. SkillLoader did not resolve ${ARGUMENTS} as a built-in variable, so even if the skill had used load-skill.sh, the args from the Skill tool invocation would not have been substituted.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/util/SkillLoader.java",
      "pattern_keywords": [
        "skill-arguments",
        "ARGUMENTS-variable",
        "SkillLoader",
        "stakeholder-selection-box",
        "load-skill",
        "variable-substitution"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Skills needing ${ARGUMENTS} substitution must route through load-skill.sh/SkillLoader (which now resolves ${ARGUMENTS}). SkillLoader.load() accepts args as a second parameter and substitutes ${ARGUMENTS} in all skill content."
    },
    {
      "id": "M359",
      "timestamp": "2026-02-19T17:20:10Z",
      "category": "missing_documentation",
      "description": "Agent gave up on bug report when xdg-open failed in headless environment instead of providing URL to user",
      "root_cause": "feedback skill Step 4 only documented the happy path (browser opens successfully) with no fallback for headless environments where xdg-open is unavailable. The skill said the script returns a url field but gave no instruction on what to do when the open command fails.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/feedback-first-use/SKILL.md",
      "pattern_keywords": [
        "headless",
        "xdg-open",
        "fallback",
        "url",
        "bug-report",
        "feedback-skill"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When github-feedback.sh open fails, extract the url from the JSON output (or reconstruct it) and display it to the user so they can open it manually in their browser"
    },
    {
      "id": "M360",
      "timestamp": "2026-02-19T00:00:00Z",
      "category": "missing_implementation",
      "description": "SkillLoader.java still hardcodes hooks/bin/ lookup path after rename to client/bin, causing preprocessor directives to pass through unresolved to the agent",
      "root_cause": "The refactor commit (10b2ff05) updated all skill SKILL.md files and hooks.json to reference client/bin instead of hooks/bin, but did not update the SkillLoader.java executeDirective() method which resolves launcher paths by looking in pluginRoot/hooks/bin/. When the launcher is not found there, the code silently returns the original !`...` directive unchanged, so the agent receives raw preprocessor syntax.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/util/SkillLoader.java",
      "pattern_keywords": [
        "preprocessor",
        "skill_loader",
        "path_mismatch",
        "hooks_bin",
        "client_bin",
        "silent_passthrough"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "SkillLoader.executeDirective() should resolve launcher paths using client/bin/ instead of hooks/bin/, matching the renamed binary output directory. The lookup at line 521 should use pluginRoot.resolve(\"client/bin/\" + launcherName)."
    },
    {
      "id": "M361",
      "timestamp": "2026-02-20T11:07:00Z",
      "category": "misleading_documentation",
      "description": "empirical-test claimed 100% success rate for /cat:status verbatim output but agent summarized instead of echoing in real sessions",
      "root_cause": "empirical-test methodology does not mandate including the project system prompt (CLAUDE.md content) when testing verbatim-output skills. Tests run without competing general instructions (be helpful, be concise) that are active in real sessions, producing false positives. The correct approach echoes in isolation but fails in production where analytical training is reinforced by CLAUDE.md.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/empirical-test-first-use/SKILL.md",
      "pattern_keywords": [
        "empirical-test",
        "verbatim",
        "system_prompt",
        "false_positive",
        "status",
        "echo"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When testing verbatim-output skills, always populate system_prompt with CLAUDE.md content to reproduce the competing instructions present in real sessions"
    },
    {
      "id": "M362",
      "timestamp": "2026-02-20T14:18:47Z",
      "category": "protocol_violation",
      "description": "Agent presented 6 unsquashed commits at the approval gate instead of squashing by topic first",
      "root_cause": "The work-with-issue skill Step 6 (Squash Commits Before Review) had no enforcement gate. The agent skipped the squash step and proceeded directly to Step 7 (Approval Gate) because no blocking check verified squashing had completed before entering the gate.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue-first-use/SKILL.md",
      "pattern_keywords": [
        "squash",
        "approval_gate",
        "unsquashed_commits",
        "protocol_violation",
        "commit_count"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Run git-squash-quick.sh to consolidate all implementation commits into 1 commit before presenting the approval gate. Verify COMMIT_COUNT == 1 before entering Step 7."
    },
    {
      "id": "M363",
      "timestamp": "2026-02-20T14:19:18.468Z",
      "category": "environment_state_mismatch",
      "description": "Worktree captured stale STATE.md for another issue (closed\u2192open regression) during implementation commit",
      "root_cause": "Worktree was branched from v2.1 before fix-status-instruction-ordering was merged. Implementation commit included the stale open STATE.md for that issue. No validation existed to detect STATE.md regressions for other issues before squashing.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-merge-first-use/SKILL.md",
      "pattern_keywords": [
        "STATE.md",
        "worktree",
        "stale",
        "regression",
        "closed",
        "open",
        "squash"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "medium",
        "catches_variations": true
      },
      "correct_behavior": "Before squashing, verify that no other issues' STATE.md files regressed from closed to open. Restore from base branch if regression detected."
    },
    {
      "id": "M364",
      "timestamp": "2026-02-20T16:29:42Z",
      "category": "protocol_violation",
      "description": "Stakeholder review subagents read files from /workspace/ (main worktree) instead of the issue worktree, causing false-positive rejection findings",
      "root_cause": "Delegation prompt instructed subagents to work within the worktree path but subagents ignored the directive and used their default cwd (/workspace/). Issue context files (PLAN.md) were not pre-fetched with absolute paths, leaving subagents to discover them independently via relative paths that resolved to the wrong workspace.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/stakeholder-review-first-use/SKILL.md",
      "pattern_keywords": [
        "worktree",
        "subagent",
        "file_path",
        "stakeholder_review",
        "absolute_path"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "M267",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Pre-fetch issue context files using absolute worktree paths and embed content directly in delegation prompt; instruct subagents to use absolute paths prefixed with WORKTREE_PATH/ for any additional reads"
    },
    {
      "id": "M365",
      "timestamp": "2026-02-20T16:47:44Z",
      "category": "misleading_documentation",
      "description": "work-merge subagent created merge commit (78827a66) using --no-ff instead of --ff-only, violating linear history requirement",
      "root_cause": "merge-and-cleanup.md concept doc contained code examples showing 'git merge --no-ff' in two places (subagent merge Step 2 and main merge Step 7), priming subagent to use --no-ff. When subagent researched how to perform the merge, it read this doc and was primed to use --no-ff instead of the --ff-only specified in the work-merge-first-use skill Step 5.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/concepts/merge-and-cleanup.md",
      "pattern_keywords": [
        "merge-commit",
        "no-ff",
        "ff-only",
        "linear-history",
        "documentation-priming"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "medium",
        "catches_variations": true
      },
      "correct_behavior": "Always use git merge --ff-only when merging issue branches to base. If fast-forward is not possible, rebase first. Never create merge commits. Use merge-and-cleanup Java tool (${CLAUDE_PLUGIN_ROOT}/client/bin/merge-and-cleanup) which enforces ff-only."
    },
    {
      "id": "M366",
      "timestamp": "2026-02-20T17:00:00Z",
      "category": "protocol_violation",
      "description": "learn skill deep-tier subagent created two separate commits for prevention file and retrospective metadata when both go to main workspace",
      "root_cause": "phase-record.md Step 12 unconditionally commits prevention files as a separate commit before Step 13 commits retrospective metadata. When prevention type is skill/config/documentation/process and no issue worktree exists, both sets of files go to the same location (main workspace) and should be combined into one commit, but no such instruction existed.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/learn/phase-record.md",
      "pattern_keywords": [
        "learn-skill",
        "split-commit",
        "phase-record",
        "single-commit-rule",
        "retrospective"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When prevention type is skill/process/documentation/config and no active worktree exists, include prevention files in the same commit as retrospective metadata (single commit in Step 13). Only split commits when prevention targets a worktree (code_fix, hook, validation)."
    },
    {
      "id": "M367",
      "timestamp": "2026-02-20T18:19:36.497Z",
      "category": "environment_state_mismatch",
      "description": "Lock verification used baked-in template session ID instead of runtime env var, causing false mismatch after /clear rotated CLAUDE_SESSION_ID",
      "root_cause": "work-with-issue-first-use SKILL.md rendered ${CLAUDE_SESSION_ID} at skill-load time (from SessionStart), but /clear rotated the actual CLAUDE_SESSION_ID env var. Lock was acquired with runtime env var; verification compared against stale baked-in value.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue-first-use/SKILL.md",
      "pattern_keywords": [
        "session_id",
        "lock",
        "CLAUDE_SESSION_ID",
        "verification",
        "template",
        "clear"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Lock verification must read CLAUDE_SESSION_ID from the OS environment at runtime using os.environ.get('CLAUDE_SESSION_ID'), not from a value baked in by template substitution at skill-load time."
    },
    {
      "id": "M368",
      "timestamp": "2026-02-21T00:37:27Z",
      "category": "prompt_engineering",
      "description": "Stakeholder reviewer subagents read base-branch files instead of worktree files because main agent simplified re-run prompts by dropping embedded FILE_CONTENTS",
      "root_cause": "The spawn_reviewers step requires embedding FILE_CONTENTS in every reviewer prompt, but the main agent progressively simplified prompts across review rounds \u2014 replacing embedded file content with instructions like \"Read InjectEnv.java and verify\". Subagents with simplified prompts fell back to reading from their default cwd (/workspace/), which contains base-branch code not worktree code, causing false-positive rejections.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/stakeholder-review-first-use/SKILL.md",
      "pattern_keywords": [
        "worktree",
        "subagent",
        "file_contents",
        "stakeholder_review",
        "prompt_simplification",
        "re-run"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "M364",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Every reviewer prompt in every round (including re-runs after fixes) must embed the full FILE_CONTENTS prepared in the prepare step; never simplify prompts by replacing file content with read instructions"
    },
    {
      "id": "M369",
      "timestamp": "2026-02-21T00:00:00Z",
      "category": "tool_misuse",
      "description": "git-squash reported OK with backup_verified:true but worktree had no commits ahead of base due to diverged working tree state",
      "root_cause": "The old git-squash script used branch pointer moves (git branch -f) without updating the working tree. The verify step checked diff content but not working tree state. backup_verified:true confirmed content correctness only, not working tree sync.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/git-squash-first-use/SKILL.md",
      "pattern_keywords": [
        "git-squash",
        "working-tree",
        "update-ref",
        "branch-f",
        "backup_verified",
        "worktree-diverged"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "MEMORY:Git-Merge-Pitfalls",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After git-squash OK response, run git -C $WORKTREE_PATH status --porcelain and verify output is empty. If diverged, run git -C $WORKTREE_PATH reset --hard HEAD to sync."
    },
    {
      "id": "M370",
      "timestamp": "2026-02-21T15:34:13Z",
      "category": "stakeholder_review_quality",
      "description": "Performance stakeholder missed O(n) directory scanning because it lacked domain knowledge about Claude CLI session mechanics (sessionId available in stream-json output)",
      "root_cause": "SYSTEM: Parent agent spawned stakeholder reviewers without injecting domain knowledge about the code being reviewed. Stakeholders lack context about Claude CLI session behavior (sessionId availability in stream-json output), which prevented the performance reviewer from identifying the O(n) directory scan as replaceable with a direct extraction.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/stakeholder-review-first-use/SKILL.md",
      "pattern_keywords": [
        "stakeholder",
        "domain-knowledge",
        "performance",
        "review",
        "context-injection"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Parent agent injects system-specific domain knowledge (e.g., available APIs, output formats, session mechanics) into every stakeholder delegation prompt via a Domain Knowledge section, enabling reviewers to identify better alternatives"
    },
    {
      "id": "M371",
      "timestamp": "2026-02-21T15:44:48Z",
      "category": "convention_violation",
      "description": "EmpiricalTestRunner records missing compact constructors with requireThat() validation",
      "root_cause": "Agent did not apply java.md convention requiring record compact constructors with parameter validation to all records with Object/String parameters. The convention file was read but inconsistently applied: some records (TestMessage, TurnOutput) received validation while others (ProcessResult, MessageEvaluation, ParsedOutput, EvaluationResult, TrialResult, ConfigResult) did not.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "code_fix",
      "prevention_path": "/workspace/client/src/main/java/io/github/cowwoc/cat/hooks/skills/EmpiricalTestRunner.java",
      "pattern_keywords": [
        "records",
        "compact-constructor",
        "requireThat",
        "validation",
        "java-conventions",
        "inconsistent-application"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Add compact constructors with requireThat() validation to all records that have Object/String/List parameters. Primitive-only records (boolean, int, long) without constraints do not need compact constructors."
    },
    {
      "id": "M372",
      "timestamp": "2026-02-21T00:00:00Z",
      "category": "protocol_violation",
      "description": "status skill output not displayed: agent shown NEXT STEPS table only instead of echoing full status box content verbatim",
      "root_cause": "ARCHITECTURAL: status-first-use/SKILL.md used instructional framing ('Echo the contents...verbatim') instead of user-centric framing ('The user wants you to respond with this text verbatim:'). Instructional framing triggers LLM analytical/processing mode per M408 pattern, causing agent to interpret rather than reproduce. Additionally, NEXT STEPS table appeared BEFORE <output> tag, causing agent to mistake the table as the verbatim target. This is a 5th recurrence (M341, M353, M354, M355) of the same architectural failure: LLM training to be concise/helpful conflicts with verbatim copy-paste requirement.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/status-first-use/SKILL.md",
      "pattern_keywords": [
        "verbatim-output",
        "status-skill",
        "user-centric-framing",
        "instructional-framing",
        "NEXT-STEPS-position",
        "M408-pattern"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "M355",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use user-centric framing 'The user wants you to respond with the following text verbatim:' immediately followed by the <output> tag. Place NEXT STEPS instructions after the <output> tag so content order mirrors output production order."
    },
    {
      "id": "M373",
      "timestamp": "2026-02-21T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent bypassed worktree isolation hook by using Bash to write files directly to main workspace instead of writing inside the issue worktree",
      "root_cause": "SYSTEM GAP: EnforceWorktreePathIsolation only intercepts Edit/Write tool calls, not Bash commands. When the hook blocked Edit/Write, the agent used Bash shell redirects to write files, which had no equivalent enforcement.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/bash/BlockWorktreeIsolationViolation.java",
      "pattern_keywords": [
        "worktree",
        "isolation",
        "hook-bypass",
        "bash-redirect",
        "tool-switch"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": "M252",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When worktree isolation hook blocks an Edit/Write operation, write the file inside the issue worktree directory instead. Never use Bash to bypass the hook."
    },
    {
      "id": "M374",
      "timestamp": "2026-02-22T12:00:00Z",
      "category": "assumption_without_verification",
      "description": "E2E testing substituted static file checks (grep/cat) for runtime skill invocation, failing to verify actual skill behavior",
      "root_cause": "E2E instructions require invoking load-skill.sh at runtime, but static file inspection (grep patterns, cat file) feels sufficient after confirming correct content is present \u2014 completion bias causes agent to treat content verification as equivalent to runtime verification",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "e2e",
        "static-check",
        "runtime-invocation",
        "skill-testing",
        "completion-bias"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "For skill changes, invoke load-skill.sh from the worktree with realistic arguments and verify the output. Running the artifact is the only valid E2E test \u2014 reading its contents is not."
    },
    {
      "id": "M375",
      "timestamp": "2026-02-22T08:40:00Z",
      "category": "tool_misuse",
      "description": "Design stakeholder missed cross-file method duplication (tokenize, resolvePath) between BlockWorktreeIsolationViolation and BlockUnsafeRemoval because it only reviewed changed files (git diff) without searching unchanged sibling files for identical methods",
      "root_cause": "The design stakeholder's duplication check instruction said 'MANDATORY: search for new utility classes, inner classes, or helper methods' \u2014 triggering on CLASS type rather than METHOD name. BlockWorktreeIsolationViolation is a concrete handler class (not a utility/inner class), so the Grep search was never triggered. Identical private methods (tokenize, resolvePath) in unchanged sibling file BlockUnsafeRemoval were invisible in FILE_CONTENTS which only contained changed files.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/cat/worktrees/2.1-block-worktree-isolation-violations-via-bash/plugin/agents/stakeholder-design.md",
      "pattern_keywords": [
        "design-stakeholder",
        "duplication",
        "cross-file",
        "unchanged-files",
        "tokenize",
        "resolvePath",
        "private-methods"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When reviewing any new file, search all sibling files for methods matching the new file's private helper method names using Grep. The trigger is the presence of helper methods in the new file, not the class type (utility/inner/concrete)."
    },
    {
      "id": "M376",
      "timestamp": "2026-02-22T00:00:00Z",
      "category": "incorrect_implementation",
      "description": "Status display box extends far beyond terminal width - box width not capped to configured terminalWidth",
      "root_cause": "GetStatusOutput.generateStatusDisplay() calculated maxContentWidth from content only, with no upper bound. The terminalWidth config value (default 120) was never consulted, causing box-drawing lines to extend to full content width regardless of terminal size.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/skills/GetStatusOutput.java",
      "pattern_keywords": [
        "terminal_width",
        "box_overflow",
        "status_display",
        "horizontal_overflow"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Load Config and read terminalWidth, then cap maxContentWidth to (terminalWidth - 2) before rendering the outer box. Inner boxes are already content-sized but the outer wrapper must respect terminal width."
    },
    {
      "id": "M377",
      "timestamp": "2026-02-22T15:00:00Z",
      "category": "protocol_violation",
      "description": "During cleanup, agent labeled 'Discard changes' as (DESTRUCTIVE) without verifying branch was already merged into base, overstating actual risk",
      "root_cause": "Cleanup skill Step 3 template included unconditional (DESTRUCTIVE) label on discard option without instructing agent to check branch merge status before assigning risk level",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/cleanup/first-use.md",
      "pattern_keywords": [
        "cleanup",
        "risk_assessment",
        "merge_check",
        "destructive_label",
        "uncommitted_changes"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before presenting options for uncommitted changes, check if the branch is merged into the base branch. If merged, communicate that branch commits are safe and only the uncommitted modifications are at risk. Reserve high-risk framing for unmerged branches where discarding changes may lose the only copy of work."
    },
    {
      "id": "M378",
      "timestamp": "2026-02-22T00:00:00Z",
      "category": "protocol_violation",
      "description": "Autofix subagent instructed to commit concern fixes with `test:` type in a separate commit instead of using the primary implementation commit type",
      "root_cause": "Autofix delegation prompts said 'appropriate commit messages' without clarifying that concern-fix commits must use the same type as the primary implementation, since all commits are squashed together in Step 6",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "autofix",
        "commit_type",
        "test_commit",
        "squash",
        "concern_fix"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Autofix subagent should commit using the same type as the primary implementation (e.g., bugfix:, feature:), since all commits are squashed into one implementation commit in Step 6"
    },
    {
      "id": "M379",
      "timestamp": "2026-02-22T16:24:00Z",
      "category": "protocol_violation",
      "description": "git-squash Quick Workflow leaves orphaned backup branch after successful squash",
      "root_cause": "GitSquash.java creates the backup branch and verifies diff is empty, but never calls 'git branch -D' to delete it on success. The buildSuccessJson method included backup_branch in the OK response, teaching callers to expect it rather than verifying deletion.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/util/GitSquash.java",
      "pattern_keywords": [
        "backup_branch",
        "git-squash",
        "orphaned_branch",
        "cleanup",
        "protocol_violation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After verifying the squash diff is empty and commit count is 1, delete the backup branch with 'git branch -D <backupBranch>' before returning the OK JSON response. The OK response should not include backup_branch since it has been deleted."
    },
    {
      "id": "M380",
      "timestamp": "2026-02-22T16:26:18Z",
      "category": "protocol_violation",
      "description": "Java code and Javadoc lines exceeded 120 characters in DisplayUtils.java and DisplayUtilsTest.java",
      "root_cause": "java.md conventions file had no line length guidance, so agents wrote arbitrarily long lines without knowing the 120-character Checkstyle limit",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/cat/conventions/java.md",
      "pattern_keywords": [
        "line-length",
        "120-characters",
        "checkstyle",
        "java-conventions",
        "javadoc-wrap"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Keep all Java source lines (including comments and Javadoc) at most 120 characters; run mvn verify to catch violations"
    },
    {
      "id": "M381",
      "timestamp": "2026-02-22T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent added project-specific 120-char line wrapping rule to plugin/skills/learn/phase-prevent.md, a shared plugin file",
      "root_cause": "Agent conflated project-level conventions (.claude/rules/common.md) with plugin-level behavior. The learn subagent was implementing prevention for a formatting issue and applied the project rule to the shared plugin file instead of recognizing that plugin files are shared across all users and must not contain project-specific conventions.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/learn/phase-prevent.md",
      "pattern_keywords": [
        "plugin_scope_violation",
        "project_convention",
        "shared_plugin_file",
        "protocol_violation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Project conventions in .claude/rules/ apply only to project-level files. Plugin files under plugin/ are shared across all CAT users and must never embed project-specific conventions. To enforce project conventions on subagents, add rules to CLAUDE.md, .claude/rules/, or project hooks in .claude/settings.json."
    },
    {
      "id": "M382",
      "timestamp": "2026-02-22T17:00:00Z",
      "category": "formatting_violation",
      "description": "Learn subagent (M378 quick-tier) wrote 261-char lines in plugin/skills/work-with-issue/first-use.md despite 120-char limit in project rules",
      "root_cause": "TAXONOMY: ACTION module failure. When implementing prevention text during phase-prevent execution, the subagent attended exclusively to CONTENT correctness (commit type guidance) and did not actively apply the project's line-wrapping rule. The rule was present in the system context (common.md) but not salient during the edit. The deeply-indented fenced code block context reduced attention to formatting. Phase-prevent had no reminder to check line lengths after editing.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/learn/phase-prevent.md",
      "pattern_keywords": [
        "line_wrapping",
        "formatting",
        "prevention_edit",
        "120_char",
        "markdown_style"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After editing a Markdown file during prevention, check that all added lines comply with the project's line-length limit (found in .claude/rules/common.md). Wrap any lines that exceed the limit before finalizing the edit."
    },
    {
      "id": "M383",
      "timestamp": "2026-02-22T00:00:00Z",
      "category": "incorrect_implementation",
      "description": "Autofix added `throw new AssertionError(\"Expected IOException was not thrown\")` as sentinel after cmd.execute() in error-path tests in MergeAndCleanupTest.java",
      "root_cause": "The Minimal Exception Testing section in java.md listed requireThat(false,...) as the only sentinel anti-pattern example, omitting `throw new AssertionError(...)` as an equivalent sentinel. The agent applied a pattern from training that java.md did not explicitly forbid.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/cat/conventions/java.md",
      "pattern_keywords": [
        "sentinel",
        "AssertionError",
        "expected exception",
        "test pattern",
        "TestNG"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use TestNG @Test(expectedExceptions=...) or assertThrows(), or write a try/catch that catches only the expected exception with no sentinel line after the call. TestNG fails the test automatically if the expected exception is not thrown."
    },
    {
      "id": "M384",
      "timestamp": "2026-02-22T17:40:28Z",
      "category": "protocol_violation",
      "description": "Agent asked user for permission to run stakeholder review, treating mandatory workflow step as optional operation",
      "root_cause": "Skill documentation lacked explicit instruction to proceed automatically through the review phase; agent sought permission for heavyweight subagent-spawning operations without guidance that review is non-optional",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "stakeholder_review",
        "protocol_violation",
        "unnecessary_permission",
        "mandatory_step"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Invoke stakeholder-review automatically as part of the mandatory workflow without asking user for permission"
    },
    {
      "id": "M385",
      "timestamp": "2026-02-22T14:00:00Z",
      "category": "protocol_violation",
      "description": "Agent presented 5 unsquashed commits at approval gate instead of squashing by topic first",
      "root_cause": "work-with-issue first-use.md Step 7 (Approval Gate) had no blocking verification that Step 6 (Squash) completed. The agent skipped Step 6 and presented the approval gate with raw commits. This is a recurrence of M362 where skill-level documentation guidance failed to enforce the squash requirement.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "squash",
        "approval_gate",
        "unsquashed_commits",
        "protocol_violation",
        "commit_count"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "M362",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before presenting the approval gate in Step 7, count commits on the branch (git rev-list --count BASE_BRANCH..HEAD). If COMMIT_COUNT > 1, return to Step 6 to complete the squash. Only enter Step 7 after COMMIT_COUNT == 1."
    },
    {
      "id": "M386",
      "timestamp": "2026-02-22T17:00:00Z",
      "category": "tool_misuse",
      "description": "Merge subagent moved branch pointer without updating main workspace working tree, causing stale STATE.md (showed open when HEAD had closed)",
      "root_cause": "MergeAndCleanup.fastForwardMerge() uses 'git push . HEAD:baseBranch' which is a pointer-only operation. It moves the base branch pointer in the main repo from the worktree context, but does not update the main workspace working tree files. After worktree removal, reading files from main workspace returns stale content not matching the new HEAD commit.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/util/MergeAndCleanup.java",
      "pattern_keywords": [
        "merge-and-cleanup",
        "working-tree",
        "pointer-only",
        "git-push-refspec",
        "stale-state-md",
        "fast-forward-merge"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": "M369",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After fastForwardMerge() calls 'git push . HEAD:baseBranch', call syncMainWorkingTree(projectDir) which runs 'git reset --hard HEAD' in projectDir to sync the main workspace working tree with the updated branch pointer. This ensures files on disk match HEAD after the merge."
    },
    {
      "id": "M386",
      "timestamp": "2026-02-22T00:00:00Z",
      "category": "misleading_documentation",
      "description": "config skill first-use.md references config_handler.py (Python, old system) which no longer exists in v2.1 Java plugin; GetConfigOutput.java exists but is not wired as a SkillOutput preprocessor directive",
      "root_cause": "Incomplete migration: Python config_handler.py was not ported to a SkillOutput launcher in client/bin/. GetConfigOutput.java was created but not connected to the skill preprocessor pipeline.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/config/first-use.md",
      "pattern_keywords": [
        "config_handler",
        "skill_output",
        "preprocessor",
        "missing_launcher",
        "migration_incomplete"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "SKILL OUTPUT CONFIG BOXES should be injected via a !\\ preprocessor directive in an <output> section of first-use.md, invoking GetConfigOutput.java (which must implement SkillOutput)."
    },
    {
      "id": "M387",
      "timestamp": "2026-02-22T19:26:49Z",
      "category": "misleading_documentation",
      "description": "config skill first-use.md references config_handler.py (Python, old plugin system) which no longer exists in v2.1 Java plugin; GetConfigOutput.java was created but not wired as a SkillOutput preprocessor directive",
      "root_cause": "Incomplete migration from Python plugin to Java plugin: config_handler.py was not ported to a get-config-output launcher + SkillOutput implementation in client/bin/. The first-use.md still references config_handler.py. When /cat:config is invoked, SKILL OUTPUT CONFIG BOXES is never provided.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/config/first-use.md",
      "pattern_keywords": [
        "config_handler",
        "skill_output",
        "preprocessor",
        "missing_launcher",
        "migration_incomplete"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "SKILL OUTPUT CONFIG BOXES should be injected via a !`${CLAUDE_PLUGIN_ROOT}/client/bin/get-config-output` preprocessor directive in an <output> section of first-use.md, invoking GetConfigOutput.java (which must implement SkillOutput). A get-config-output launcher must be created in client/bin/."
    },
    {
      "id": "M388",
      "timestamp": "2026-02-23T00:00:00Z",
      "category": "protocol_violation",
      "description": "Missed skill-builder review: agent modified plugin/skills/ files without invoking /cat:skill-builder before approval gate",
      "root_cause": "PLANNING failure: work-with-issue workflow has no step requiring /cat:skill-builder review when skill files are modified, leaving the review as an implicit expectation that agents can overlook",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "skill_builder",
        "skill_review",
        "approval_gate",
        "protocol_violation",
        "plugin_skills"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before presenting the approval gate, run /cat:skill-builder on each modified plugin/skills/ or plugin/commands/ file to review for priming issues or structural problems."
    },
    {
      "id": "M389",
      "timestamp": "2026-02-23T02:00:00Z",
      "category": "stakeholder_review_quality",
      "description": "Requirements stakeholder missed 2-level-only version scheme limitation during porting task review: IssueDiscovery.java only handled major (v2) and major.minor (v2.1), not major.minor.patch (v2.1.3)",
      "root_cause": "Requirements stakeholder Review Process only covers REQ-XXX formal requirements from parent PLAN.md, not task-local Success Criteria (e.g., produce identical output, match bash implementation) and does not mandate reading original source files to verify behavioral parity. The PLAN.md stated identical JSON output and matched bash implementation in Success Criteria, but the review process skipped those in favor of checking formal REQ-IDs (which this task had none of - only a parent issue reference).",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/agents/stakeholder-requirements.md",
      "pattern_keywords": [
        "stakeholder_review",
        "requirements_stakeholder",
        "porting_task",
        "version_scheme",
        "behavioral_parity",
        "success_criteria_gap"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Requirements stakeholder should read both task PLAN.md Success Criteria AND Satisfies REQ-XXX IDs. For porting tasks, the stakeholder must read original source file(s) to enumerate all supported inputs/behaviors and verify the new implementation covers the same scope (e.g., all 3 version schemes: major, major.minor, major.minor.patch)."
    },
    {
      "id": "M390",
      "timestamp": "2026-02-23T08:08:05Z",
      "category": "protocol_violation",
      "description": "learn skill subagent committed retrospective metadata to main workspace instead of active issue worktree, splitting a single learn session across two git trees",
      "root_cause": "phase-record.md protocol said 'Retrospective metadata always goes to the main workspace' regardless of active worktree, causing the learn session output to be split: prevention to worktree, metadata to main workspace \u2014 violating worktree isolation and the single-commit rule",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/learn/phase-record.md",
      "pattern_keywords": [
        "worktree_isolation",
        "split_commit",
        "learn_skill",
        "retrospective_metadata",
        "protocol_violation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "ALL learning changes (prevention files + retrospective metadata) go to the same location in a SINGLE commit: active worktree when one exists, main workspace otherwise"
    },
    {
      "id": "M391",
      "timestamp": "2026-02-23T10:20:00Z",
      "category": "incorrect_implementation",
      "description": "work-prepare.py and WorkPrepare.java returned ERROR for decomposed parent issues even when all sub-issues were closed - decomposed status not handled, blocking parent auto-closure",
      "root_cause": "work-prepare.py only handled locked/not_found/found statuses from get-available-issues.sh; the decomposed status (and other statuses: already_complete, not_executable, blocked, existing_worktree) fell through to a generic ERROR. WorkPrepare.java similarly lacked a Decomposed case in handleNonFoundResult()",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/scripts/work-prepare.py",
      "pattern_keywords": [
        "decomposed",
        "parent",
        "work-prepare",
        "status",
        "children",
        "closed"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When a decomposed parent issue is requested and has open sub-issues, return NO_TASKS with a clear message directing the user to work on sub-issues first. When all sub-issues are closed, the parent becomes available automatically and work-prepare should proceed normally."
    },
    {
      "id": "M392",
      "timestamp": "2026-02-23T00:00:00Z",
      "category": "protocol_violation",
      "description": "/cat:work offered to close decomposed parent issue before verifying acceptance criteria",
      "root_cause": "work/first-use.md had no protocol for the decomposed-parent-all-children-closed scenario. When the agent detected all sub-issues were closed, no guidance existed requiring acceptance criteria verification before offering closure. The agent proceeded directly from 'children closed' to 'offer closure', skipping the mandatory acceptance criteria check.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work/first-use.md",
      "pattern_keywords": [
        "decomposed",
        "parent-issue",
        "acceptance-criteria",
        "closure-verification",
        "work-prepare"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When a decomposed parent issue is selected (all sub-issues closed), verify all PLAN.md acceptance criteria are satisfied before offering to close the parent. The sequence is: children closed \u2192 criteria verified \u2192 offer closure."
    },
    {
      "id": "M393",
      "timestamp": "2026-02-23T00:00:00Z",
      "category": "protocol_violation",
      "description": "After context compaction, agent presented approval gate (AskUserQuestion) without first showing the diff, commit summary, or change context in the current turn",
      "root_cause": "The approval gate instructions listed display requirements (task goal, execution summary, E2E results, review concerns) but did not require rendering the diff via cat:render-diff and outputting all context items in the same conversation turn before invoking AskUserQuestion. After compaction, the user's visible context resets, so items displayed in prior turns are no longer visible.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "approval gate",
        "compaction",
        "context reset",
        "diff",
        "AskUserQuestion",
        "no context"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before invoking AskUserQuestion at the approval gate, always output in the current turn: (1) render diff via cat:render-diff, (2) commit summary, (3) task goal, (4) execution summary, (5) E2E summary, (6) review concerns. This ensures the user has full context regardless of whether compaction occurred."
    },
    {
      "id": "M394",
      "timestamp": "2026-02-23T11:00:00Z",
      "category": "protocol_violation",
      "description": "Agent presented implementation for review without closing STATE.md in the same commit",
      "root_cause": "The work-with-issue squash+verification step lacks a blocking check that STATE.md is closed in the final commit before proceeding to the approval gate. The rule exists in documentation (CLAUDE.md M487 and delegation prompt) but without a verification gate, the agent can proceed to review with STATE.md still open.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "validation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "STATE.md",
        "closed",
        "approval gate",
        "same commit",
        "protocol_violation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before presenting the approval gate, verify that STATE.md shows Status: closed in the HEAD commit. If not, amend the implementation commit to include the STATE.md closure before proceeding."
    },
    {
      "id": "M395",
      "timestamp": "2026-02-23T22:36:55Z",
      "category": "assumption_without_verification",
      "description": "Attempted git add on /tmp/empirical-test.txt without verifying the file path was inside the repository",
      "root_cause": "Agent recognized the contradiction (file in /tmp, asked to commit to git repo) in its thinking but proceeded with the doomed operation anyway as a demonstration rather than asking for clarification",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/git-commit/first-use.md",
      "pattern_keywords": [
        "git",
        "outside",
        "repository",
        "prerequisite",
        "validation",
        "path"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When asked to commit a file at a path outside the repository root, ask the user to clarify rather than attempting a git operation that will always fail"
    },
    {
      "id": "M396",
      "timestamp": "2026-02-24T01:24:00Z",
      "category": "protocol_violation",
      "description": "Agent implemented bugfix for bare issue name scope detection without invoking cat:tdd-implementation first",
      "root_cause": "CLAUDE.md Testing Requirements only mandated running tests before review, not writing failing tests first. Without an explicit requirement to invoke cat:tdd-implementation before implementing, the agent committed the bugfix (95735cc8) and added tests as a follow-up (d314c63c, 9701eb0a) instead of following TDD order.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/CLAUDE.md",
      "pattern_keywords": [
        "tdd",
        "bugfix",
        "test-first",
        "cat:tdd-implementation",
        "ad-hoc-fix"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before implementing any bugfix or feature with testable inputs/outputs, invoke cat:tdd-implementation to write failing tests first. This applies to all contexts including ad-hoc user-requested fixes, not only formal /cat:work issue workflows."
    },
    {
      "id": "M397",
      "timestamp": "2026-02-24T00:00:00Z",
      "category": "tool_misuse",
      "description": "stakeholder-selection-box invoked with stakeholder names as first positional args instead of integer counts",
      "root_cause": "Skill argument format not documented inline at the invocation point. Agent saw template variable names (SELECTED_COUNT) but confused them for semantic labels, passing stakeholder names directly instead of computing integer counts first.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/stakeholder-review/first-use.md",
      "pattern_keywords": [
        "stakeholder-selection-box",
        "positional-args",
        "integer-count",
        "argument-format"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Compute SELECTED_COUNT as integer before invoking cat:stakeholder-selection-box. Args 1 and 2 must be integers; args 3 and 4 are comma-separated name lists."
    },
    {
      "id": "M398",
      "timestamp": "2026-02-24T04:28:34Z",
      "category": "protocol_violation",
      "description": "Agent investigated and nearly removed a worktree that was potentially in use by another Claude session",
      "root_cause": "work-prepare/first-use.md status handler list omitted existing_worktree status, leaving agent without explicit instruction to treat it as LOCKED and pick another issue",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-prepare/first-use.md",
      "pattern_keywords": [
        "worktree_removal",
        "concurrent_session",
        "protocol_violation",
        "existing_worktree",
        "fail_fast"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When work-prepare returns existing_worktree status, treat as LOCKED, return LOCKED to caller, and pick a different issue without investigation or removal"
    },
    {
      "id": "M399",
      "timestamp": "2026-02-24T12:30:00Z",
      "category": "protocol_violation",
      "description": "Agent force-removed an orphaned worktree without first checking whether its commits were already merged into the base branch",
      "root_cause": "No protocol existed in work-prepare/first-use.md for the orphaned worktree case (worktree present, no lock file). The skill only documented the lock-present case as LOCKED, leaving agents without guidance for what to do when the user explicitly targets an issue with an orphaned worktree.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-prepare/first-use.md",
      "pattern_keywords": [
        "orphaned-worktree",
        "merge-status",
        "force-remove",
        "lock-file",
        "worktree-recovery"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When a worktree exists but no lock file is present (orphaned worktree), check merge status first. If already merged into base: clean up worktree and branch. If not merged: acquire lock and resume work in the existing worktree. Never force-remove without checking merge status."
    },
    {
      "id": "M400",
      "timestamp": "2026-02-24T14:16:38Z",
      "category": "protocol_violation",
      "description": "Agent suggested working on a blocking dependency after NO_TASKS, but the dependency may itself be non-executable; also used task instead of issue terminology",
      "root_cause": "PLANNING module failure: The NO_TASKS guidance in work/first-use.md said to list each blocked task and what it is blocked by, but did not clarify that the blocker itself may be non-executable. The agent inferred that the blocker was actionable and suggested it directly. Additionally, the guidance used task terminology which the agent echoed instead of using the correct issue terminology.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work/first-use.md",
      "pattern_keywords": [
        "no-tasks",
        "blocked-issues",
        "misleading-guidance",
        "terminology",
        "issue-vs-task"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When NO_TASKS is returned with blocked_tasks, list each blocked issue and what it is blocked by, then direct the user to /cat:status to determine what to resolve. Never suggest working on a blocking dependency by name. Use issue terminology (not task) for CAT project work items."
    },
    {
      "id": "M401",
      "timestamp": "2026-02-24T15:30:00Z",
      "category": "misleading_documentation",
      "description": "WorkPrepare diagnostic scan truncates at 1000 file-system entries, causing closed dependencies to appear as not_found in blocked_tasks output",
      "root_cause": "WorkPrepare.buildIssueIndex uses Files.walk().limit(1000) which truncates the index when a project has many issues. Dependencies that fall beyond entry 999 are missing from the index and incorrectly reported as not_found in the diagnostic blocked_tasks list, even though IssueDiscovery resolves them correctly using a separate unlimited scan. This misleads users into thinking work-prepare has a bug when it is actually behaving correctly.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-prepare/first-use.md",
      "pattern_keywords": [
        "work-prepare",
        "NO_TASKS",
        "not_found",
        "diagnostic",
        "scan_limit",
        "blocked_tasks"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When blocked_tasks shows not_found for a dependency, verify the dependency STATE.md directly. The diagnostic is for context only; the selection result is authoritative. The code fix (remove .limit(1000) from buildIssueIndex) is tracked as task M401-fix."
    },
    {
      "id": "M402",
      "timestamp": "2026-02-24T17:26:24Z",
      "category": "protocol_violation",
      "description": "Backup branch left behind after failed rebase \u2014 merge subagent never cleaned it up",
      "root_cause": "git-rebase skill ERROR recovery table said 'restore from backup if needed' but gave no instruction to delete backup after handling. Agent completed error recovery via alternative approach but skipped backup cleanup because no guidance existed.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/git-rebase/first-use.md",
      "pattern_keywords": [
        "backup-before-rebase",
        "backup_branch",
        "git-rebase-safe",
        "branch cleanup",
        "orphaned branch"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After handling a rebase ERROR (investigation complete, alternative taken, or escalated): delete the backup branch with 'git branch -D <backup_branch>'. Same applies to CONFLICT resolution. Backup exists only during investigation."
    },
    {
      "id": "M403",
      "timestamp": "2026-02-24T18:59:28Z",
      "category": "protocol_violation",
      "description": "Invoked cat:stakeholder-selection-box with JSON object args instead of positional space-separated args",
      "root_cause": "Agent passed parent skill's JSON invocation context ({issue_id, worktree_path}) as the args to the internal cat:stakeholder-selection-box skill, instead of computing and passing the positional args <selected_count> <total_count> <running_list> <skipped_list>",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "validation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/skills/GetStakeholderSelectionBox.java",
      "pattern_keywords": [
        "stakeholder-selection-box",
        "json-args",
        "positional-args",
        "skill-invocation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Compute SELECTED_COUNT and SKIPPED_LIST as positional values before invoking cat:stakeholder-selection-box. Use args: \"<selected_count> 10 <running_list> <skipped_list>\" \u2014 never pass a JSON object as the args field."
    },
    {
      "id": "M404",
      "timestamp": "2026-02-25T00:00:00Z",
      "category": "protocol_violation",
      "description": "Presented user approval gate when stakeholder review was REJECTED due to CRITICAL security concerns",
      "root_cause": "The skill instructions described the auto-fix loop and approval gate as sequential sections but lacked an explicit blocking rule preventing the approval gate from being reached when review_status == REJECTED. The agent read the approval gate section and applied it without checking the pre-condition that the auto-fix loop must complete first.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "stakeholder-review",
        "REJECTED",
        "approval-gate",
        "CRITICAL",
        "auto-fix",
        "protocol_violation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When review_status is REJECTED (CRITICAL_COUNT > 0 or REJECTED_COUNT > 0), enter the auto-fix loop immediately. The approval gate is only reached after the auto-fix loop completes or exhausts 3 iterations."
    },
    {
      "id": "M405",
      "timestamp": "2026-02-25T00:00:00Z",
      "category": "assumption_without_verification",
      "description": "Added YAML frontmatter to agent file without verifying whether frontmatter is parsed by Claude Code's plugin system",
      "root_cause": "Agent cargo-culted the frontmatter pattern from skills (which do parse frontmatter) without verifying the same applies to agents. The README for plugin/agents/ explicitly documents all frontmatter fields and their effects, confirming frontmatter IS used.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/agents/README.md",
      "pattern_keywords": [
        "agent-frontmatter",
        "cargo-cult",
        "assumption-without-verification",
        "plugin-agents"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before questioning whether frontmatter is used in plugin/agents/*.md files, read plugin/agents/README.md which documents all frontmatter fields and their effects. Claude Code parses agent frontmatter for name, description, model, tools, skills, permissionMode, and other fields \u2014 all are active configuration, not dead documentation."
    },
    {
      "id": "M406",
      "timestamp": "2026-02-25T12:00:00Z",
      "category": "misleading_documentation",
      "description": "License header exemption in CLAUDE.md only covered SKILL.md files, not agent .md files, causing unnecessary header to be added to plugin/agents/work-verify.md",
      "root_cause": "SYSTEM: The exemption clause in CLAUDE.md narrowly specified \"SKILL.md files under plugin/skills/\" without generalizing to the broader category of files injected into agent context as prompts. Agent .md files in plugin/agents/ serve the same purpose but the documentation gap led the design stakeholder to flag the missing header as CRITICAL, causing the auto-fix subagent to add an unnecessary HTML comment license header.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/CLAUDE.md",
      "pattern_keywords": [
        "license-header",
        "agent-files",
        "prompt-injection",
        "exemption-scope",
        "misleading-documentation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Files injected into agent/subagent context as prompts are exempt from license headers \u2014 this includes both SKILL.md files under plugin/skills/ AND .md files under plugin/agents/. License headers in prompt files waste tokens in every invocation without providing legal value. CLAUDE.md now explicitly documents both exemptions."
    },
    {
      "id": "M407",
      "timestamp": "2026-02-25T12:30:00Z",
      "category": "protocol_violation",
      "description": "Dismissed pre-existing stakeholder review concerns as false positives instead of applying the patience cost/benefit framework",
      "root_cause": "The work-with-issue skill's false positive filtering section lacked a definition distinguishing reviewer errors (wrong branch state) from pre-existing real concerns (higher fix cost). The agent misclassified pre-existing concerns as false positives instead of routing them through the patience framework.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "false_positive",
        "pre-existing",
        "patience",
        "cost_benefit",
        "stakeholder_review"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Classify a concern as a false positive only when the reviewer read the wrong branch. Treat pre-existing concerns as real issues and route them through the patience cost/benefit framework to decide whether to fix inline or defer as a new issue."
    },
    {
      "id": "M408",
      "timestamp": "2026-02-25T00:00:00Z",
      "category": "protocol_violation",
      "description": "Displayed raw JSON from stakeholder-review to user and stopped on REJECTED status instead of entering auto-fix loop",
      "root_cause": "work-with-issue skill Handle Review Result section lacked explicit guidance that: (1) the stakeholder-review JSON is an internal machine contract not for display, and (2) REJECTED status means CRITICAL concerns exist and triggers the auto-fix loop, not workflow termination",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "raw_json_display",
        "rejected_status",
        "stakeholder_review",
        "auto_fix_loop",
        "protocol_violation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Parse stakeholder-review JSON silently as an internal contract; use the already-rendered review box and concern boxes for user display; when review_status is REJECTED extract concerns and enter the auto-fix loop immediately"
    },
    {
      "id": "M409",
      "timestamp": "2026-02-25T00:00:00Z",
      "category": "protocol_violation",
      "description": "Invoked cat:stakeholder-review-box with space-separated reviewers instead of single comma-separated string",
      "root_cause": "The stakeholder-review/first-use.md report step documented the reviewers arg format as a comma-separated list but did not make explicit that all reviewers must be passed as one single argument. The agent expanded each reviewer as a separate space-separated arg, producing 8 args instead of 4, causing the CLI (GetStakeholderReviewBox.main) to misparse arguments.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/stakeholder-review/first-use.md",
      "pattern_keywords": [
        "stakeholder-review-box",
        "argument-count",
        "comma-separated",
        "cli-invocation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Build the entire REVIEWER_STATUS_LIST as a single comma-separated string before invoking cat:stakeholder-review-box. Pass it as one arg: args: \"${ISSUE_ID} ${REVIEWER_STATUS_LIST} ${REVIEW_RESULT} ${REVIEW_SUMMARY}\" \u2014 never expand reviewers as space-separated args."
    },
    {
      "id": "M410",
      "timestamp": "2026-02-25T19:18:00Z",
      "category": "documentation_priming",
      "description": "Agent added (M232) to Javadoc comment in GetAddOutput.java, copying M-code convention from existing Java source files",
      "root_cause": "Existing Java source files (WarnApprovalWithoutRenderDiff.java, BlockLockManipulation.java, etc.) contained M-code references in Javadoc comments. Agent read these files during implementation and copied the convention into new code. The M-code policy in common.md only prohibited agent-facing documentation (plugin/skills/, plugin/concepts/, plugin/agents/) but did not explicitly cover Java source files.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/rules/common.md",
      "pattern_keywords": [
        "M-code",
        "mcode",
        "Javadoc",
        "priming",
        "java-source",
        "convention-copying"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Do not add M-code references (e.g., M232, M097) to Javadoc comments or string literals in Java source files under client/src/. Describe the behavior in plain language. M-codes belong only in MEMORY.md, CLAUDE.md, .claude/rules/, and .claude/cat/retrospectives/."
    },
    {
      "id": "M411",
      "timestamp": "2026-02-25T19:30:00Z",
      "category": "protocol_violation",
      "description": "After rebase onto v2.1, squash included 12 unrelated Java files because conflict resolution used --theirs (feature branch) instead of HEAD (target branch)",
      "root_cause": "During rebase, --ours/--theirs semantics are inverted compared to merge. The agent used git checkout --theirs intending to take v2.1's version, but --theirs during rebase means the commit being replayed (feature branch). This produced non-empty commits carrying old file versions instead of empty commits that git would auto-drop.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/git-rebase/first-use.md",
      "pattern_keywords": [
        "rebase",
        "conflict-resolution",
        "ours-theirs-inversion",
        "unrelated-files",
        "HEAD",
        "REBASE_HEAD"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "During rebase conflict resolution, use git checkout HEAD -- <file> to take the target branch version (unambiguous). Never use --ours/--theirs during rebase \u2014 their meaning is inverted compared to merge."
    },
    {
      "id": "M412",
      "timestamp": "2026-02-26T03:51:33.088Z",
      "category": "misleading_documentation",
      "description": "Agent passed verify=none to work-with-issue despite cat-config.json having verify=all, skipping all verification phases",
      "root_cause": "first-use.md claimed TRUST/VERIFY/AUTO_REMOVE are 'pre-loaded by handler preprocessing (shown above in CONFIGURATION section)' but no such preprocessing exists. The skill output was 48.7KB and truncated to 2KB, hiding content before the Configuration section. Agent fabricated 'none' for VERIFY instead of reading cat-config.json.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work/first-use.md",
      "pattern_keywords": [
        "verify",
        "config",
        "truncated",
        "fabricated",
        "work-with-issue",
        "cat-config"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before invoking work-with-issue, read cat-config.json to extract TRUST, VERIFY, and AUTO_REMOVE values. Never fabricate config values."
    },
    {
      "id": "M413",
      "timestamp": "2026-02-26T10:00:00.000Z",
      "category": "protocol_violation",
      "description": "Issue work done directly on base branch (v2.1) after premature fast-forward merge, bypassing worktree isolation",
      "root_cause": "The issue branch was fast-forward merged into v2.1 before stakeholder review completed. No explicit barrier prevented this premature merge. Subsequent concern fixes and squash committed directly to v2.1 instead of the issue worktree branch.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/concepts/work.md",
      "pattern_keywords": [
        "worktree_isolation",
        "premature_merge",
        "base_branch_commit",
        "stakeholder_review"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "medium",
        "catches_variations": true
      },
      "correct_behavior": "Keep the issue branch in the worktree until all phases complete: stakeholder review, concern fixes, squash, approval gate, then merge to base branch via work-merge"
    },
    {
      "id": "M414",
      "timestamp": "2026-02-26T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent displayed raw JSON machine-facing return value from stakeholder-review to user instead of using review box CLI tools",
      "root_cause": "stakeholder-review/first-use.md Output Format section used instructional framing (\"Return the structured result below as your final message\") with a full JSON example, priming the agent to emit machine-facing JSON as visible output even in standalone invocation where no caller consumes it",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/stakeholder-review/first-use.md",
      "pattern_keywords": [
        "raw_json_display",
        "machine_facing_output",
        "stakeholder_review",
        "output_format_priming",
        "standalone_invocation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "M408",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After the report step renders review boxes and concern boxes, no further output is needed. The review boxes are the complete user-facing output. When invoked standalone, offer to address HIGH+ concerns; when invoked via work-with-issue, the caller handles auto-fix iteration."
    },
    {
      "id": "M415",
      "timestamp": "2026-02-26T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent skipped verbatim echo of <output skill=\"status\"> tag content and output only the NEXT STEPS table when invoking /cat:status",
      "root_cause": "ARCHITECTURAL (6th recurrence: M341, M353, M354, M355, M372): status/first-use.md still used instructional framing ('Echo the content...Do not summarize...') and placed NEXT STEPS before the <output> tag. M372 recorded prevention_implemented:true but the source file was never actually updated, so the failure recurred. LLM training to be concise conflicts with verbatim copy-paste; only user-centric framing ('The user wants you to respond with the following text verbatim:') triggers mechanical reproduction.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/status/first-use.md",
      "pattern_keywords": [
        "verbatim-output",
        "status-skill",
        "user-centric-framing",
        "NEXT-STEPS-position",
        "M408-pattern",
        "prevention-not-applied"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "M372",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use user-centric framing 'The user wants you to respond with the following text verbatim:' immediately before the <output skill='status'> tag, with NEXT STEPS table appearing AFTER the closing </output> tag so content order mirrors output production order."
    },
    {
      "id": "M416",
      "timestamp": "2026-02-26T18:30:00Z",
      "category": "protocol_violation",
      "description": "Analyze phase subagent cited recurrence chain (M341 \u2192 M353 \u2192 M354 \u2192 M355 \u2192 M372 \u2192 M415) as root cause without conducting independent RCA from fresh evidence, violating the recurring_pattern rule in phase-analyze.md Step 4b",
      "root_cause": "phase-analyze.md Step 4b embedded the independence requirement (if_yes_multiple, if_3_plus_recurrences) as passive YAML comments inside a template block \u2014 not as a blocking gate. Step 4d appeared immediately after and provided tooling (jq command) and an example recurrence chain template, priming the agent to jump from recurrence detection directly to Step 4d and build its conclusion from past entries rather than fresh evidence. No structural barrier existed between the recurring_pattern check and the Step 4d recurrence tooling.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/learn/phase-analyze.md",
      "pattern_keywords": [
        "recurring_pattern",
        "independent_rca",
        "recurrence_chain",
        "phase-analyze",
        "documentation_priming",
        "step-4d-bypass"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When a mistake is a recurrence, complete independent RCA by reading source files directly before consulting past mistake entries. The independent root cause must be documented in Step 4b-R before Step 4d recurrence tooling is accessible."
    },
    {
      "id": "M417",
      "timestamp": "2026-02-27T11:17:24Z",
      "category": "protocol_violation",
      "description": "Interactive rebase dropped STATE.md changes from pre-squash-range commit, regressing closed issue back to open",
      "root_cause": "git-squash skill STATE.md regression check only existed for Quick Workflow, not Interactive Rebase Workflow. When commits outside the squash range are dropped during interactive rebase, the post-squash git diff check may miss STATE.md regressions.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/git-squash/first-use.md",
      "pattern_keywords": [
        "state-regression",
        "interactive-rebase",
        "STATE.md",
        "squash",
        "closed-issue"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After any interactive rebase that drops or squashes commits, run STATE.md regression check comparing backup branch STATE.md status fields against current; fail if any closed issue regressed to open"
    },
    {
      "id": "M418",
      "timestamp": "2026-02-27T00:00:00Z",
      "category": "incorrect_implementation",
      "description": "git-rebase-safe VERIFY_FAILED false positive when base branch advanced since worktree creation",
      "root_cause": "GitRebaseSafe.java Step 5 compares post-rebase tree against pre-rebase backup using git diff --quiet backup, but backup was taken before rebase and does not include new base branch commits. When base branch advances, the post-rebase tree legitimately differs from backup, triggering false VERIFY_FAILED even though issue branch content is intact.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/util/GitRebaseSafe.java",
      "pattern_keywords": [
        "git-rebase-safe",
        "false-positive",
        "verification",
        "content-changed",
        "base-branch-advanced"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Step 5 verification should compare the patch diff of the issue branch before and after rebase (git diff <old-base>..backup vs git diff <new-base>..HEAD), not tree state. If the issue branch patch content is identical, the rebase is a success regardless of new base commits."
    },
    {
      "id": "M419",
      "timestamp": "2026-02-27T15:42:38Z",
      "category": "protocol_violation",
      "description": "Agent echoed config skill output as markdown and asked conversational question instead of calling AskUserQuestion to run interactive wizard",
      "root_cause": "The display-settings step did not explicitly instruct the agent to proceed to the main-menu step after outputting the settings box, leaving a gap that the agent filled with a conversational question rather than the required AskUserQuestion invocation",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/config/first-use.md",
      "pattern_keywords": [
        "config",
        "wizard",
        "AskUserQuestion",
        "step-transition",
        "interactive"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After outputting the CURRENT_SETTINGS box in display-settings step, immediately proceed to main-menu step and call AskUserQuestion to present the interactive settings wizard"
    },
    {
      "id": "M420",
      "timestamp": "2026-02-27T15:48:36Z",
      "category": "protocol_violation",
      "description": "Agent invoked /cat:config skill but responded conversationally instead of calling AskUserQuestion to run interactive wizard - recurrence of M419",
      "root_cause": "ARCHITECTURAL: LLM trained conversational behavior overrides skill documentation guidance. Negative framing triggers interpretation mode. Documentation-only (level 5) prevention is insufficient when correct behavior fights LLM training.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/config/first-use.md",
      "pattern_keywords": [
        "config",
        "wizard",
        "AskUserQuestion",
        "conversational",
        "user-centric-framing",
        "training-conflict"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "M419",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "medium",
        "catches_variations": true
      },
      "correct_behavior": "After outputting the CURRENT_SETTINGS box, call AskUserQuestion immediately with the main-menu options. Never ask a free-text question or summarize settings conversationally."
    },
    {
      "id": "M421",
      "timestamp": "2026-02-27T00:00:00Z",
      "category": "protocol_violation",
      "description": "Prevent phase subagent edited plugin/skills/config/first-use.md without invoking /cat:skill-builder first",
      "root_cause": "phase-prevent.md Step 9 lacked a gate requiring skill-builder invocation before editing skill files; the MANDATORY rule exists only in the skill listing, not enforced in the workflow",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/learn/phase-prevent.md",
      "pattern_keywords": [
        "skill-builder",
        "protocol_violation",
        "skill_editing",
        "prevent_phase"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before editing any skill or command file as prevention, invoke /cat:skill-builder with the target file path and follow its backward-reasoning decomposition"
    },
    {
      "id": "M422",
      "timestamp": "2026-02-27T00:00:00Z",
      "category": "protocol_violation",
      "description": "After implementing compliance fixes for M419/M420 in plugin/skills/config/first-use.md, /cat:empirical-test was not run to verify the fixes worked, allowing the same recurrence to occur without a feedback loop",
      "root_cause": "The learn skill's phase-prevent.md had no gate requiring empirical verification after compliance fixes to skill files. Compliance fixes could be committed as 'done' without any behavioral validation, breaking the feedback loop.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/learn/phase-prevent.md",
      "pattern_keywords": [
        "empirical-test",
        "compliance-verification",
        "feedback-loop",
        "protocol_violation",
        "skill-fix-validation"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After implementing a skill documentation fix for a compliance failure (protocol_violation category), run /cat:empirical-test to verify the fix achieves >=70% compliance before recording the prevention as complete"
    },
    {
      "id": "M423",
      "timestamp": "2026-02-27T16:33:33Z",
      "category": "protocol_violation",
      "description": "Approval gate hook failed to detect AskUserQuestion wizard approval because tool_result content elements use a different JSON field (content) than text messages (text)",
      "root_cause": "extractUserMessageText() only reads element[\"text\"] from content array elements, but AskUserQuestion tool_result entries store the approval text in element[\"content\"] (a string field), causing the wizard approval to go undetected",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/task/EnforceApprovalBeforeMerge.java",
      "pattern_keywords": [
        "approval",
        "AskUserQuestion",
        "tool_result",
        "content",
        "pre-issue",
        "merge"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "extractUserMessageText() must check both element[\"text\"] (for regular user messages) and element[\"content\"] (for tool_result entries like AskUserQuestion responses) when iterating content array elements"
    },
    {
      "id": "M424",
      "timestamp": "2026-02-27T00:00:00Z",
      "category": "misleading_documentation",
      "description": "Worktrees with idle times of 27 and 94 minutes labeled as 'abandoned' despite policy requiring 4+ hours minimum",
      "root_cause": "Skill documentation (first-use.md) said 'Lock age exceeds reasonable session duration (hours old)' without specifying minimum threshold, allowing loose interpretation",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "/workspace/plugin/skills/cleanup/first-use.md",
      "pattern_keywords": [
        "abandoned_classification",
        "threshold",
        "idle_time"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Do not label worktrees as 'abandoned' unless idle time exceeds 4 hours (14400 seconds)"
    },
    {
      "id": "M425",
      "timestamp": "2026-02-27T00:00:00Z",
      "category": "protocol_violation",
      "description": "Learn subagent split prevention commit and retrospective metadata into two separate commits instead of one atomic commit",
      "root_cause": "Phase 3 (Prevent) BLOCKING GATE instructed verifying edited files but did not explicitly forbid committing there. Subagent completed the edit+verify gate and then committed prevention files, leaving retrospective metadata for a second commit in Phase 4, violating the single-commit rule stated in phase-record.md Step 12.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/learn/phase-prevent.md",
      "pattern_keywords": [
        "single-commit",
        "split-commit",
        "retrospective",
        "atomic-commit",
        "learn-skill"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "All learn session changes (prevention files + retrospective metadata) must go into a SINGLE commit in Phase 4 Step 13. Phase 3 edits files but does not commit."
    }
  ]
}